/********************************************************************************
 * Copyright (C) 2024 Sanyam IDE contributors.
 *
 * This program and the accompanying materials are made available under the
 * terms of the MIT License, which is available in the project root.
 *
 * SPDX-License-Identifier: MIT
 ********************************************************************************/

/* Composite editor uses Lumino BoxLayout for proper widget management */
.sanyam-composite-editor {
    height: 100%;
    width: 100%;
    overflow: hidden;
}

/* Content panel holds the editor/diagram - uses Lumino BoxPanel */
.sanyam-composite-editor-content {
    height: 100%;
    width: 100%;
    overflow: hidden;
}

/* Embedded text editor from Monaco */
.sanyam-composite-text-editor {
    height: 100%;
    width: 100%;
}

/* Embedded diagram widget */
.sanyam-composite-diagram {
    height: 100%;
    width: 100%;
}

/* ============================================
   Diagram Widget Styles
   ============================================ */

.sanyam-diagram-widget {
    height: 100%;
    width: 100%;
    overflow: hidden;
}

.sanyam-diagram-container {
    display: flex;
    flex-direction: row;
    height: 100%;
    width: 100%;
}

.sanyam-diagram-tool-palette {
    /* Hide tool palette when empty - will be shown when tools are added */
    display: none;
    width: 40px;
    min-width: 40px;
    background-color: var(--theia-sideBar-background, #252526);
    border-right: 1px solid var(--theia-sideBar-border, #3c3c3c);
}

.sanyam-diagram-tool-palette.has-tools {
    display: flex;
    flex-direction: column;
}

.sanyam-diagram-svg-container {
    flex: 1;
    height: 100%;
    overflow: hidden;
    background-color: var(--theia-editor-background, #1e1e1e);
    position: relative;
}

/* Placeholder shown when no model is loaded */
.sanyam-diagram-placeholder {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    width: 100%;
    color: var(--theia-descriptionForeground, #717171);
}

.sanyam-diagram-placeholder-icon {
    font-size: 48px;
    margin-bottom: 16px;
    opacity: 0.5;
}

.sanyam-diagram-placeholder-text {
    text-align: center;
}

.sanyam-diagram-placeholder-text p {
    margin: 4px 0;
}

.sanyam-diagram-placeholder-text p.secondary {
    font-size: 12px;
    opacity: 0.7;
}

/* Loading spinner */
.sanyam-diagram-loading-spinner {
    width: 40px;
    height: 40px;
    margin-bottom: 16px;
    border: 3px solid var(--theia-descriptionForeground, #717171);
    border-top-color: var(--theia-focusBorder, #007fd4);
    border-radius: 50%;
    animation: sanyam-diagram-spin 1s linear infinite;
}

@keyframes sanyam-diagram-spin {
    to {
        transform: rotate(360deg);
    }
}

/* Error state */
.sanyam-diagram-error .sanyam-diagram-placeholder-icon {
    color: var(--theia-editorError-foreground, #f48771);
}

.sanyam-diagram-error .sanyam-diagram-placeholder-text p:first-child {
    color: var(--theia-editorError-foreground, #f48771);
}

/* SVG diagram styles */
.sanyam-diagram-svg {
    background-color: var(--theia-editor-background, #1e1e1e);
}

.sanyam-node-rect {
    fill: var(--theia-editor-background, #1e1e1e);
    stroke: var(--theia-foreground, #cccccc);
    stroke-width: 1px;
}

.sanyam-node.selected .sanyam-node-rect {
    stroke: var(--theia-focusBorder, #007fd4);
    stroke-width: 2px;
}

.sanyam-edge-path {
    fill: none;
    stroke: var(--theia-foreground, #cccccc);
    stroke-width: 1px;
}

.sanyam-edge.selected .sanyam-edge-path {
    stroke: var(--theia-focusBorder, #007fd4);
    stroke-width: 2px;
}

.sanyam-label {
    fill: var(--theia-foreground, #cccccc);
    font-size: 12px;
}

/* ============================================
   Tab Bar Styles - Horizontal bar at the bottom
   ============================================ */

.sanyam-composite-editor-tab-bar {
    display: flex;
    flex-direction: row;
    align-items: stretch;
    justify-content: flex-start;
    padding: 0;
    gap: 0;
    background-color: var(--theia-editorGroupHeader-tabsBackground, #252526);
    border-top: 1px solid var(--theia-editorGroupHeader-tabsBorder, #3c3c3c);
    min-height: 32px;
    height: 32px;
}

/* Editor Tab Styles */
.sanyam-editor-tab {
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    gap: 6px;
    padding: 0 16px;
    min-width: 80px;
    height: 100%;
    border: none;
    border-right: 1px solid var(--theia-editorGroupHeader-tabsBorder, #3c3c3c);
    background-color: transparent;
    color: var(--theia-tab-inactiveForeground, #969696);
    font-size: 12px;
    cursor: pointer;
    transition: background-color 0.15s ease, color 0.15s ease;
    user-select: none;
}

.sanyam-editor-tab:hover:not(.disabled) {
    background-color: var(--theia-tab-hoverBackground, #2a2d2e);
    color: var(--theia-tab-hoverForeground, #ffffff);
}

.sanyam-editor-tab:focus {
    outline: 1px solid var(--theia-focusBorder, #007fd4);
    outline-offset: -1px;
}

.sanyam-editor-tab.active {
    background-color: var(--theia-tab-activeBackground, #1e1e1e);
    color: var(--theia-tab-activeForeground, #ffffff);
    border-bottom: 2px solid var(--theia-focusBorder, #007fd4);
}

.sanyam-editor-tab.active:hover {
    background-color: var(--theia-tab-activeBackground, #1e1e1e);
}

.sanyam-editor-tab.disabled {
    opacity: 0.4;
    cursor: not-allowed;
}

.sanyam-editor-tab.disabled:hover {
    background-color: transparent;
    color: var(--theia-tab-inactiveForeground, #969696);
}

.sanyam-editor-tab-icon {
    font-size: 14px;
}

.sanyam-editor-tab-label {
    font-weight: 400;
}

.sanyam-editor-tab.active .sanyam-editor-tab-label {
    font-weight: 500;
}

/* Light theme adjustments */
.theia-light .sanyam-composite-editor-tab-bar {
    background-color: var(--theia-editorGroupHeader-tabsBackground, #f3f3f3);
    border-top: 1px solid var(--theia-editorGroupHeader-tabsBorder, #e7e7e7);
}

.theia-light .sanyam-editor-tab {
    color: var(--theia-tab-inactiveForeground, #616161);
    border-right: 1px solid var(--theia-editorGroupHeader-tabsBorder, #e7e7e7);
}

.theia-light .sanyam-editor-tab:hover:not(.disabled) {
    background-color: var(--theia-tab-hoverBackground, #e8e8e8);
    color: var(--theia-tab-hoverForeground, #000000);
}

.theia-light .sanyam-editor-tab.active {
    background-color: var(--theia-tab-activeBackground, #ffffff);
    color: var(--theia-tab-activeForeground, #333333);
}

/* High contrast theme adjustments */
.theia-hcDark .sanyam-composite-editor-tab-bar {
    background-color: var(--theia-editorGroupHeader-tabsBackground, #000000);
    border-top: 1px solid var(--theia-contrastBorder, #6fc3df);
}

.theia-hcDark .sanyam-editor-tab {
    border-right: 1px solid var(--theia-contrastBorder, #6fc3df);
}

.theia-hcDark .sanyam-editor-tab.active {
    border-bottom: 2px solid var(--theia-contrastActiveBorder, #f38518);
}

.theia-hcLight .sanyam-composite-editor-tab-bar {
    background-color: var(--theia-editorGroupHeader-tabsBackground, #ffffff);
    border-top: 1px solid var(--theia-contrastBorder, #0f4a85);
}

.theia-hcLight .sanyam-editor-tab {
    border-right: 1px solid var(--theia-contrastBorder, #0f4a85);
}

.theia-hcLight .sanyam-editor-tab.active {
    border-bottom: 2px solid var(--theia-contrastActiveBorder, #0f4a85);
}

/* ============================================
   Toolbar Group Separators
   ============================================ */

.lm-TabBar-toolbar > .item:has(> [id="sanyam.diagram.toolbar.zoomToFit"]),
.lm-TabBar-toolbar > .item:has(> [id="sanyam.diagram.toolbar.layout"]),
.lm-TabBar-toolbar > .item:has(> [id="sanyam.diagram.toolbar.edgeRouteOrthogonal"]),
.lm-TabBar-toolbar > .item:has(> [id="sanyam.diagram.toolbar.minimap"]),
.lm-TabBar-toolbar > .item:has(> [id="sanyam.diagram.toolbar.refresh"]) {
    margin-left: 4px;
    padding-left: 4px;
    border-left: 1px solid var(--theia-activityBar-border, rgba(128, 128, 128, 0.35));
}
